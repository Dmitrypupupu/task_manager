# Тестирование Системы Управления Заметками

## Описание

Система тестирования включает автоматические тесты для проверки функциональности программы управления заметками. Тесты покрывают основные функции валидации ввода и управления заметками.

## Запуск тестов

### Команда Make

Самый простой способ запустить все тесты:

```bash
make test
```

Эта команда скомпилирует тесты и автоматически запустит их.

### Ручная компиляция и запуск

Если вы хотите скомпилировать тесты вручную:

```bash
g++ -std=c++17 -Wall -Wextra -O2 -o test_runner test.cpp note.cpp validation.cpp
./test_runner
```

### Очистка

Для удаления скомпилированных тестов:

```bash
make clean-all
```

## Покрытие тестов

### Тесты валидации (15 тестов)

#### Валидация названия заметки (4 теста)
- ✅ Корректные названия разной длины
- ✅ Пустое название
- ✅ Слишком длинное название (>100 символов)
- ✅ Название состоящее только из пробелов

#### Валидация категории/темы (4 теста)
- ✅ Корректные категории
- ✅ Пустая категория
- ✅ Слишком длинная категория (>50 символов)
- ✅ Категория состоящая только из пробелов

#### Валидация содержимого (4 теста)
- ✅ Корректное содержимое
- ✅ Пустое содержимое
- ✅ Слишком длинное содержимое (>10000 символов)
- ✅ Максимально допустимая длина (10000 символов)

#### Валидация выбора меню (2 теста)
- ✅ Корректный выбор в диапазоне
- ✅ Выбор вне допустимого диапазона

#### Валидация даты (1 тест)
- ✅ Формат даты ГГГГ-ММ-ДД

### Тесты NoteManager (13 тестов)

#### Инициализация (1 тест)
- ✅ Правильная инициализация менеджера

#### Добавление заметок (3 теста)
- ✅ Успешное добавление одной заметки
- ✅ Добавление нескольких заметок
- ✅ Проверка на дублирование названий

#### Проверка существования (2 теста)
- ✅ Проверка существования заметки по ID
- ✅ Поиск индекса заметки в массиве

#### Удаление заметок (3 теста)
- ✅ Успешное удаление существующей заметки
- ✅ Попытка удаления несуществующей заметки
- ✅ Удаление нескольких заметок с проверкой корректности

#### Сохранение и загрузка (2 теста)
- ✅ Сохранение и загрузка метаданных
- ✅ Сохранение и загрузка содержимого заметок

#### Дополнительные тесты (2 теста)
- ✅ Проверка ограничения на максимальное количество заметок
- ✅ Генерация безопасных путей к файлам

## Структура тестов

### Макросы для тестирования

```cpp
TEST(test_name)           // Объявление теста
RUN_TEST(test)            // Запуск теста с автоматическим подсчетом результатов
ASSERT_TRUE(condition)    // Проверка истинности условия
ASSERT_FALSE(condition)   // Проверка ложности условия
ASSERT_EQUAL(a, b)        // Проверка равенства значений
```

### Пример теста

```cpp
TEST(test_validate_title_valid) {
    ASSERT_TRUE(validateNoteTitle("Правильное название"));
    ASSERT_TRUE(validateNoteTitle("A"));
    ASSERT_TRUE(validateNoteTitle("123"));
}
```

## Результаты тестирования

После запуска тестов вы увидите:
- Список всех запущенных тестов
- Статус каждого теста (PASSED/FAILED)
- Итоговую статистику:
  - Количество пройденных тестов (зеленым цветом)
  - Количество проваленных тестов (красным цветом)
  - Общее количество тестов

### Пример вывода

```
=== ЗАПУСК ТЕСТОВ СИСТЕМЫ УПРАВЛЕНИЯ ЗАМЕТКАМИ ===

--- Тесты валидации названия ---
Запуск теста: test_validate_title_valid... PASSED
Запуск теста: test_validate_title_empty... PASSED
...

=== РЕЗУЛЬТАТЫ ТЕСТИРОВАНИЯ ===
Тесты пройдены: 28
Тесты провалены: 0
Всего тестов: 28
```

## Автоматическая очистка

Тесты автоматически очищают тестовые данные:
- Удаляют файл метаданных `notes_metadata.dat`
- Удаляют директорию `notes/` с тестовыми файлами

Это гарантирует, что каждый тест запускается в чистом окружении.

## Добавление новых тестов

Чтобы добавить новый тест:

1. Создайте функцию теста с макросом `TEST`:
```cpp
TEST(my_new_test) {
    // Ваш тестовый код
    ASSERT_TRUE(someCondition);
}
```

2. Добавьте вызов теста в функцию `main()`:
```cpp
RUN_TEST(my_new_test);
```

## Непрерывная интеграция

Тесты можно легко интегрировать в CI/CD pipeline:

```bash
make test
if [ $? -eq 0 ]; then
    echo "Все тесты пройдены успешно"
else
    echo "Некоторые тесты провалились"
    exit 1
fi
```

## Устранение неполадок

### Ошибка компиляции

Если тесты не компилируются, убедитесь что:
- Установлен компилятор g++ с поддержкой C++17
- Все исходные файлы находятся в той же директории

### Тесты не запускаются

Проверьте права на выполнение:
```bash
chmod +x test_runner
./test_runner
```

### Ошибки при работе с файлами

Убедитесь, что у вас есть права на создание и удаление файлов в текущей директории.

## Рекомендации

1. **Запускайте тесты перед коммитом** изменений в репозиторий
2. **Добавляйте новые тесты** при добавлении новой функциональности
3. **Обновляйте существующие тесты** при изменении логики программы
4. **Следите за покрытием** - стремитесь к покрытию критически важных функций

## Известные ограничения

- Тесты не покрывают пользовательский интерфейс (UI.cpp)
- Тесты не проверяют интерактивный ввод пользователя
- Не тестируется корректность работы с различными кодировками
- Не проверяется поведение при отсутствии прав на запись

Эти ограничения связаны с консольной природой приложения и сложностью тестирования интерактивного ввода.
